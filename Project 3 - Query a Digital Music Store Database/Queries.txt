{\rtf1\ansi\ansicpg1252\cocoartf2759
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\fs24 \cf0 Query 1\
--Find the total number of tracks in each genre.\
SELECT g.Name AS Genre,\
       COUNT(t.TrackId) AS TotalTracks\
FROM Genre g\
JOIN Track t ON g.GenreId = t.GenreId\
GROUP BY g.Name;\
\
Query 2\
--  Calculate the average duration of tracks in each album.\
SELECT a.Title AS Album,\
       AVG(t.Milliseconds) / 1000 AS Avg_Duration_In_Seconds\
FROM Album a\
JOIN Track t ON a.AlbumId = t.AlbumId\
GROUP BY a.Title;\
\
Query 3\
--   List the top 5 customers who spent the most money on purchases.\
SELECT c.FirstName || ' ' || c.LastName AS CustomerName,\
       SUM(il.UnitPrice * il.Quantity) AS TotalSpent\
FROM Customer c\
JOIN Invoice i ON c.CustomerId = i.CustomerId\
JOIN InvoiceLine il ON i.InvoiceId = il.InvoiceId\
GROUP BY c.CustomerId\
ORDER BY TotalSpent DESC\
LIMIT 5;\
\
Query 4\
-- Query 4: Find the total number of invoices generated per employee within a specific period\
SELECT e.FirstName || ' ' || e.LastName AS EmployeeName,\
       COUNT(i.InvoiceId) AS TotalInvoices\
FROM Employee e\
JOIN Customer c ON e.EmployeeId = c.SupportRepId\
JOIN Invoice i ON c.CustomerId = i.CustomerId\
GROUP BY e.EmployeeId;\
}